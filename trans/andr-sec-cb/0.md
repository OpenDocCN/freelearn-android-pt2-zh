# 零、前言

安卓已经迅速成为最受欢迎的移动操作系统之一，不仅对用户如此，对各种开发公司也是如此。当然，正因为如此，它也成为了一个非常受恶意对手欢迎的平台。

自 2005 年以来，安卓一直在公共领域运行，其功能和复杂性都有了巨大的增长。一般来说，移动智能手机现在拥有关于用户的非常敏感的信息，以及访问他们的电子邮件、短信、社交和专业网络服务的权限。与任何软件一样，这种能力和复杂性的增加也带来了安全风险的增加；软件变得越强大、越复杂，它们就越难管理和适应这个糟糕的大世界。

这尤其适用于移动智能手机上的软件。这些个人和敏感信息的热点提供了一个有趣的解决问题的安全环境。从一个角度来看，移动智能手机的安全环境很难与网络或“云”中的服务器相提并论，因为它们本质上不是移动的。它们不容易移动或被盗；我们可以强制实施软件和物理安全措施，以保护对它们的未授权访问。我们还可以持续监控它们，并自动快速响应安全事件。对于我们放在口袋和手提包里随身携带的设备，而在出租车上却忘记了，游戏环境是完全不同的！

安卓用户和开发者表示，他们需要不断意识到自己的移动安全风险，由于这一需求，移动安全和风险评估专家和安全工程师的需求量很大。这本书旨在平滑初露头角的安卓安全评估专家的学习曲线，并作为经验丰富的安卓安全专业人员破解常见安卓安全问题的工具。

# **这本书涵盖了什么**

[第 1 章](1.html#page "Chapter 1. Android Development Tools")、*安卓开发工具、*向我们介绍了开发人员在安卓平台上搭建安卓应用和原生级组件所使用的工具的设置和运行。这一章也是对那些刚接触安卓系统的人的介绍，他们想知道如何设置通用的开发环境和工具。

[第二章](2.html#page "Chapter 2. Engaging with Application Security")、*与应用安全*交战，向我们介绍安卓操作系统提供的组件，致力于保护应用。本章涵盖了用于保护应用及其与操作系统交互的一些安全相关工具和服务的手动检查和使用。

[第 3 章](3.html#page "Chapter 3. Android Security Assessment Tools")*安卓安全评估工具*介绍了安卓安全专家使用的一些流行的以及新的和即将推出的安全工具和框架，以评估应用给用户带来的技术风险。在这里，您将学习设置、运行和扩展将在后面章节中使用的黑客和逆向工程工具。

[第 4 章](4.html#page "Chapter 4. Exploiting Applications")、*开发应用*，涵盖了针对安卓应用的外壳开发技术。本章的内容涵盖了所有安卓应用组件类型，并详细介绍了如何从源代码和应用间上下文来检查它们的安全风险。它还介绍了[第 3 章](3.html#page "Chapter 3. Android Security Assessment Tools")中介绍的工具的更高级用法，安卓安全评估工具。

[第 5 章](5.html#page "Chapter 5. Protecting Applications")、*保护应用*，旨在与[第 4 章](4.html#page "Chapter 4. Exploiting Applications")开发应用完全相反。本章讨论的不是纯粹的应用缺陷，而是应用修复。它向读者介绍了开发人员可以用来保护应用免受某些攻击的有用技术，这些技术在[第 4 章](4.html#page "Chapter 4. Exploiting Applications")“利用应用”中有详细介绍。

[第 6 章](6.html#page "Chapter 6. Reverse Engineering Applications")、*逆向工程应用*，帮助读者学会破解打开应用，并教给他们安卓逆向工程师用来检查和分析应用的技术。您将非常详细地了解 Dex 文件格式，以及如何将 Dex 字节码解释为有用的表示形式，从而使逆向工程更加容易。本章还介绍了逆向工程师在安卓操作系统上运行时可以用来动态分析应用和本机组件的新方法。

[第 7 章](7.html#page "Chapter 7. Secure Networking")、*安全联网*，帮助读者深入研究应用开发人员在网络传输过程中保护数据的实用方法。使用这些技术，您将能够为安全套接字层(SSL)通信添加更强的验证。

[第 8 章](8.html#page "Chapter 8. Native Exploitation and Analysis")、*原生开发与分析*，致力于涵盖针对安卓平台原生环境的安全评估和测试技术。读者将学会寻找安全缺陷，这些缺陷可用于根手机和提升安卓系统上的权限，以及对本地服务进行低级攻击，包括内存损坏和竞争条件利用。

[第 9 章](9.html#page "Chapter 9. Encryption and Developing Device Administration Policies")*加密和开发设备管理策略*，重点介绍了如何正确使用加密并避免一些常见的反模式，以确保应用中的数据安全。它推荐了几个健壮且省时的第三方库来快速而安全地增强应用的安全性。最后，我们将介绍如何使用安卓设备管理应用编程接口来实现和实施企业安全策略。

# 这本书你需要什么

虽然这本书有一些软件要求，但书中的许多演练讨论了下载和安装所需的软件，然后才真正开始使用它们来促进正在讨论的主题。

也就是说，在开始演练之前，这里列出了您可能需要的软件:

*   安卓软件开发工具包
*   安卓原生开发套件(NDK)
*   GNU C/C++编译器
*   GNU 调试器(GDB)
*   Python，最好是 2.7，但 3.0 应该可以
*   虚拟盒子
*   Ettercap(适用于 Windows 或 Linux/Unix 系统)
*   Dex2Jar
*   Objdump(对象转储)
*   radansa
*   图形用户界面
*   Java 开发工具包(JDK)
*   安卓安全评估框架 drozer
*   OpenSSL 命令行工具
*   keytool 命令行工具

# 这本书是给谁的

这本书的一些章节致力于开发安卓应用，另一些章节专注于强化它们，旨在展示硬币的两面，攻击者和防御者。

安全研究人员、分析师和渗透测试人员将享受如何利用安卓应用的细节。希望了解更多安全知识的应用开发人员将获得如何保护其应用免受攻击的实用建议。

# 惯例

在这本书里，你会发现许多区分不同种类信息的文本风格。以下是这些风格的一些例子和对它们的意义的解释。

文本中的码字、数据库表名、文件夹名、文件名、文件扩展名、路径名、伪 URL、用户输入和 Twitter 句柄如下所示:“必须使用`–t`开关指定您在上一步中选择的系统映像 ID。”

代码块设置如下:

```java
from drozer import android
from drozer.modules import common, Module
class AttackSurface(Module,common.Filters, common.PackageManager):
```

当我们希望将您的注意力吸引到代码块的特定部分时，相关的行或项目以粗体显示，如下所示:

```java
from drozer import android
from drozer.modules import common, Module
class AttackSurface(Module,common.Filters, common.PackageManager):

```

任何命令行输入或输出都编写如下:

```java
sudo aptitude update //If you have aptitude installed

```

**新名词**和**重要词语**以粗体显示。例如，您在屏幕、菜单或对话框中看到的单词会出现在这样的文本中:“一旦您接受了许可，您就可以通过单击**安装**来收集您的文档和应用编程接口”。

### 注

警告或重要提示会出现在这样的框中。

### 类型

提示和技巧是这样出现的。

# 读者反馈

我们随时欢迎读者的反馈。让我们知道你对这本书的看法——你喜欢或可能不喜欢什么。读者反馈对我们开发您真正能从中获得最大收益的标题非常重要。

要给我们发送一般反馈，只需向`<[feedback@packtpub.com](mailto:feedback@packtpub.com)>`发送电子邮件，并通过您的消息主题提及书名。

如果你对某个主题有专业知识，并且对写作或投稿感兴趣，请参阅我们在[www.packtpub.com/authors](http://www.packtpub.com/authors)上的作者指南。

# 客户支持

现在，您已经自豪地拥有了一本书，我们有许多东西可以帮助您从购买中获得最大收益。

## 下载示例代码

您可以从您在[http://www.packtpub.com](http://www.packtpub.com)的账户中下载您购买的所有 Packt 书籍的示例代码文件。如果您在其他地方购买了这本书，您可以访问[http://www.packtpub.com/support](http://www.packtpub.com/support)并注册，以便将文件直接通过电子邮件发送给您。

## 勘误表

尽管我们尽了最大努力来确保我们内容的准确性，但错误还是会发生。如果你在我们的某本书里发现了错误——可能是文本或代码中的错误——如果你能向我们报告，我们将不胜感激。通过这样做，你可以让其他读者免受挫折，并帮助我们改进这本书的后续版本。如果您发现任何勘误表，请访问[http://www.packtpub.com/submit-errata](http://www.packtpub.com/submit-errata)，选择您的书籍，点击**勘误表提交表**链接，并输入您的勘误表的详细信息。一旦您的勘误表得到验证，您的提交将被接受，勘误表将上传到我们的网站上，或添加到该标题的勘误表部分下的任何现有勘误表列表中。通过从[http://www.packtpub.com/support](http://www.packtpub.com/support)中选择您的标题，可以查看任何现有的勘误表。

## 盗版

互联网上版权材料的盗版是所有媒体的一个持续问题。在 Packt，我们非常重视版权和许可证的保护。如果您在互联网上遇到任何形式的我们作品的非法拷贝，请立即向我们提供位置地址或网站名称，以便我们寻求补救。

请通过`<[copyright@packtpub.com](mailto:copyright@packtpub.com)>`联系我们，获取疑似盗版资料的链接。

我们感谢您在保护我们作者方面的帮助，以及我们为您带来有价值内容的能力。

## 问题

如果您对本书的任何方面有问题，可以在`<[questions@packtpub.com](mailto:questions@packtpub.com)>`联系我们，我们将尽最大努力解决。