["```kt\n$ git clone https://android.googlesource.com/platform/external/sepolicy\n$ cd sepolicy\n\n```", "```kt\n$ git checkout b5ffb\n\n```", "```kt\n$ cd ..\n$ rm -rf udoo/external/sepolicy\n$ cp -r sepolicy udoo/external/sepolicy\n\n```", "```kt\n$ rm –rf udoo/external/sepolicy/.git\n\n```", "```kt\n$ grep -nw setool udoo/build/core/Makefile\n\n```", "```kt\n$ . setup udoo-userdebug\n$ make -j8 2>&1 | tee logz\n\n```", "```kt\n$ mkdir ~/userdata\n$ sudo mount /dev/sdd4 ~/userdata\n$ cd ~/userdata/\n$ sudo rm -rf *\n$ cd ..\n$ sudo umount ~/userdata\n\n```", "```kt\n$ mkdir ~/udoo-cts\n$ cd ~/udoo-cts\n$ wget https://dl.google.com/dl/android/cts/android-cts-4.3_r2-linux_x86-arm.zip\n$ unzip android-cts-4.3_r2-linux_x86-arm.zip\n\n```", "```kt\n$ ./cts-tradefed\n11-30 10:30:08 I/: Detected new device 0123456789ABCDEF\ncts-tf > run cts --plan CTS\ncts-tf > \ntime passes here\n11-30 10:30:28 I/TestInvocation: Starting invocation for 'cts' on build '4.3_r2' on device 0123456789ABCDEF\n11-30 10:30:28 I/0123456789ABCDEF: Created result dir 2014.11.30_10.30.28\n11-30 10:31:44 I/0123456789ABCDEF: Collecting device info\n11-30 10:31:45 I/0123456789ABCDEF: -----------------------------------------\n11-30 10:31:45 I/0123456789ABCDEF: Test package android.aadb started\n11-30 10:31:45 I/0123456789ABCDEF: -----------------------------------------\n11-30 10:32:15 I/0123456789ABCDEF: com.android.cts.aadb.TestDeviceFuncTest#testBugreport PASS \n...\n\n```", "```kt\ncts-tf > l i\nCommand Id  Exec Time Device State \n1 8m:22 0123456789ABCDEF running cts on build 4.3_r2 \n\n```", "```kt\n11-30 10:30:28 I/0123456789ABCDEF: Created result dir 2014.11.30_10.30.28\n\n```", "```kt\n#============= adbd ==============\nallow adbd ashmem_device:chr_file execute;\nallow adbd dumpstate:unix_stream_socket connectto;\nallow adbd dumpstate_socket:sock_file write;\nallow adbd input_device:chr_file { write getattr open };\nallow adbd log_device:chr_file { write read ioctl open };\nallow adbd logcat_exec:file { read getattr open execute execute_no_trans };\nallow adbd mediaserver:binder { transfer call };\nallow adbd mediaserver:fd use;\nallow adbd self:capability { net_raw dac_override };\nallow adbd self:process execmem;\nallow adbd shell_data_file:file { execute execute_no_trans };\nallow adbd system_server:binder { transfer call };\nallow adbd tmpfs:file execute;\nallow adbd unlabeled:dir getattr;\n```", "```kt\ntype=1400 msg=audit(1417416666.182:788): avc: denied { execute } for pid=3680 comm=\"Compiler\" path=2F6465762F6173686D656D2F64616C76696B2D6A69742D636F64652D6361636865202864656C6574656429 dev=tmpfs ino=412027 scontext=u:r:adbd:s0 tcontext=u:object_r:tmpfs:s0 tclass=file\ntype=1400 msg=audit(1417416670.352:831): avc: denied { execute } for pid=3753 comm=\"Compiler\" path=\"/dev/ashmem\" dev=tmpfs ino=1127 scontext=u:r:adbd:s0 tcontext=u:object_r:ashmem_device:s0 tclass=chr_file\n\n```", "```kt\n$ adb shell ps -Z | grep adbd\nu:r:adbd:s0 root 20046 1 /sbin/adbd\nu:r:adbd:s0 root 20101 20046 ps\n\n```", "```kt\nu:r:adbd:s0 root 20046 1 /sbin/adbd\nu:r:adbd:s0 root 20101 20046 ps\n\n```", "```kt\n$ adb shell\nroot@udoo:/ # id\nuid=0(root) gid=0(root) context=u:r:adbd:s0\n\n```", "```kt\nroot@udoo:/ # ls -Z /system/bin/sh\nlrwxr-xr-x root shell u:object_r:system_file:s0 sh -> mksh\nroot@udoo:/ # ls -Z /system/bin/mksh\n-rwxr-xr-x root shell u:object_r:system_file:s0 mksh\n\n```", "```kt\n$ cat file_contexts | grep shell_exec\n/system/bin/sh -- u:object_r:shell_exec:s0\n\n```", "```kt\ntype=1400 msg=audit(1417405835.872:435): avc: denied { getattr } for pid=4078 comm=\"ls\" path=\"/device\" dev=mmcblk0p7 ino=2 scontext=u:r:adbd:s0 tcontext=u:object_r:unlabeled:s0 tclass=dir\n\n```", "```kt\nroot@udoo:/ # mount | grep device\n/dev/block/mmcblk0p7 /device ext4 ro,seclabel,nosuid,nodev,relatime,user_xattr,barrier=1,data=ordered 0 0\n\n```", "```kt\ntype udoo_device_file, file_type;\n```", "```kt\nallow domain udoo_device_file:dir getattr;\n```", "```kt\n/device u:object_r:udoo_device_file:s0\n```", "```kt\n#============= adbd ==============\nallow adbd audit_log:file { read getattr open };\n```", "```kt\n# dont audit adb pull and adb shell cat of audit logs\ndontaudit adbd audit_log:file r_file_perms;\ndontaudit shell audit_log:file r_file_perms;\n```", "```kt\n# Make sure no one adds an allow to the audit logs\n# from anything but system server (read only) and\n# auditd, rw access.\nneverallow { domain -system_server -auditd -init -kernel } audit_log:file ~getattr;\nneverallow system_server audit_log:file ~r_file_perms;\n```", "```kt\n#============= bootanim ==============\nallow bootanim init:unix_stream_socket connectto;\nallow bootanim log_device:chr_file { write open };\nallow bootanim property_socket:sock_file write;\n```", "```kt\ntype=1400 msg=audit(1417405616.640:255): avc: denied { connectto } for pid=2534 comm=\"BootAnimation\" path=\"/dev/socket/property_service\" scontext=u:r:bootanim:s0 tcontext=u:r:init:s0 tclass=unix_stream_socket\n\n```", "```kt\nallow domain udoo_device_file:dir getattr;\nallow domain log_device:dir search;\nallow domain log_device:chr_file rw_file_perms;\n```", "```kt\n#============= debuggerd ==============\nallow debuggerd log_device:chr_file { write read open };\nallow debuggerd system_data_file:sock_file write;\n```", "```kt\ntype=1400 msg=audit(1417415122.602:502): avc: denied { write } for pid=2284 comm=\"debuggerd\" name=\"ndebugsocket\" dev=mmcblk0p4 ino=129525 scontext=u:r:debuggerd:s0 tcontext=u:object_r:system_data_file:s0 tclass=sock_file\n\n```", "```kt\nsystem_server.te:297:type_transition system_server system_data_file:sock_file system_ndebug_socket \"ndebugsocket\";\n\n```", "```kt\n#============= drmserver ==============\nallow drmserver log_device:chr_file { write open };\n```", "```kt\n#============= dumpstate ==============\nallow dumpstate init:binder call;\nallow dumpstate init:process signal;\nallow dumpstate log_device:chr_file { write read open };\nallow dumpstate node:rawip_socket node_bind;\nallow dumpstate self:capability sys_resource;\nallow dumpstate system_data_file:file { write rename create setattr };\n```", "```kt\n$ adb shell ps -Z | grep init\nu:r:init:s0 root 1 0 /init\nu:r:init:s0 root 2286 1 zygote\nu:r:init:s0 radio 2759 2286 com.android.phone\n\n```", "```kt\n# zygote\ntype zygote, domain;\ntype zygote_exec, exec_type, file_type;\n```", "```kt\n#============= keystore ==============\nallow keystore app_data_file:file write;\nallow keystore log_device:chr_file { write open };\n```", "```kt\ntype=1400 msg=audit(1417417454.442:845): avc: denied { write } for pid=15339 comm=\"onCtsTestRunner\" path=\"/data/data/com.android.cts.stub/cache/CTS_DUMP\" dev=mmcblk0p4 ino=131242 scontext=u:r:keystore:s0 tcontext=u:object_r:app_data_file:s0:c512,c768 tclass=file\n\n```", "```kt\nuser=_app domain=untrusted_app type=app_data_file levelFrom=user\nuser=_app seinfo=platform domain=platform_app type=app_data_file levelFrom=user\n```", "```kt\n#============= mediaserver ==============\nallow mediaserver adbd:binder { transfer call };\nallow mediaserver init:binder { transfer call };\nallow mediaserver log_device:chr_file { write open };\n```", "```kt\n#============= netd ==============\nallow netd kernel:system module_request;\nallow netd log_device:chr_file { write open };\n```", "```kt\n#============= rild ==============\nallow rild log_device:chr_file { write open };\n```", "```kt\n#============= servicemanager ==============\nallow servicemanager init:binder transfer;\nallow servicemanager log_device:chr_file { write open };\n```", "```kt\n#============= surfaceflinger ==============\nallow surfaceflinger init:binder transfer;\nallow surfaceflinger log_device:chr_file { write open };\n```", "```kt\n#============= system_server ==============\nallow system_server adbd:binder { transfer call };\nallow system_server dalvikcache_data_file:file { write setattr };\nallow system_server init:binder { transfer call };\nallow system_server init:file write;\nallow system_server init:process { setsched sigkill getsched };\nallow system_server init_tmpfs:file read;\nallow system_server log_device:chr_file write;\n```", "```kt\ntype=1400 msg=audit(1417405611.550:159): avc: denied { write } for pid=2571 comm=\"er.ServerThread\" name=\"system@app@SettingsProvider.apk@classes.dex\" dev=mmcblk0p4 ino=129458 scontext=u:r:system_server:s0 tcontext=u:object_r:dalvikcache_data_file:s0 tclass=file\ntype=1400 msg=audit(1417405611.550:160): avc: denied { setattr } for pid=2571 comm=\"er.ServerThread\" name=\"system@app@SettingsProvider.apk@classes.dex\" dev=mmcblk0p4 ino=129458 scontext=u:r:system_server:s0 tcontext=u:object_r:dalvikcache_data_file:s0 tclass=file\n\n```", "```kt\n#============= toolbox ==============\nallow toolbox sysfs:file write;\n```", "```kt\ntype=1400 msg=audit(1417405599.660:43): avc: denied { write } for pid=2309 comm=\"cat\" path=\"/sys/module/usbtouchscreen/parameters/calibration\" dev=sysfs ino=2318 scontext=u:r:toolbox:s0 tcontext=u:object_r:sysfs:s0 tclass=file\n\n```", "```kt\n#============= untrusted_app ==============\nallow untrusted_app adb_device:chr_file getattr;\nallow untrusted_app adbd:binder { transfer call };\nallow untrusted_app adbd:dir { read getattr open search };\nallow untrusted_app adbd:file { read getattr open };\nallow untrusted_app adbd:lnk_file read;\n...\n```", "```kt\nallow untrusted_app device:chr_file { read getattr };\nallow untrusted_app unlabeled:dir { read getattr open };\n```", "```kt\ntype=1400 msg=audit(1417416653.742:620): avc: denied { read } for pid=3696 comm=\"onCtsTestRunner\" name=\"rfkill\" dev=tmpfs ino=1126 scontext=u:r:untrusted_app:s0:c512,c768 tcontext=u:object_r:device:s0 tclass=chr_file\ntype=1400 msg=audit(1417416666.152:784): avc: denied { getattr } for pid=3696 comm=\"onCtsTestRunner\" path=\"/dev/mxs_viim\" dev=tmpfs ino=1131 scontext=u:r:untrusted_app:s0:c512,c768 tcontext=u:object_r:device:s0 tclass=chr_file\ntype=1400 msg=audit(1417416653.592:561): avc: denied { getattr } for pid=3696 comm=\"onCtsTestRunner\" path=\"/dev/.coldboot_done\" dev=tmpfs ino=578 scontext=u:r:untrusted_app:s0:c512,c768 tcontext=u:object_r:device:s0 tclass=file\n\n```", "```kt\nfile_contexts:/sys/class/rfkill/rfkill[0-9]*/state -- u:object_r:sysfs_bluetooth_writable:s0\nfile_contexts:/sys/class/rfkill/rfkill[0-9]*/type -- u:object_r:sysfs_bluetooth_writable:s0\n```", "```kt\n# touch screen calibration\n/sys/module/usbtouchscreen/parameters/calibration -- u:object_r:sysfs_touchscreen_calibration:s0\n#BT RFKill node\n/sys/class/rfkill/rfkill[0-9]*/state -- u:object_r:sysfs_bluetooth_writable:s0\n/sys/class/rfkill/rfkill[0-9]*/type -- u:object_r:sysfs_bluetooth_writable:s0\n```", "```kt\n#============= vold ==============\nallow vold log_device:chr_file { write open };\n```", "```kt\n#============= watchdogd ==============\nallow watchdogd device:chr_file { read write create unlink open };\n```", "```kt\ntype=1400 msg=audit(1417405598.000:8): avc: denied { create } for pid=2267 comm=\"watchdogd\" name=\"__null__\" scontext=u:r:watchdogd:s0 tcontext=u:object_r:device:s0 tclass=chr_file\ntype=1400 msg=audit(1417405598.000:9): avc: denied { read write } for pid=2267 comm=\"watchdogd\" name=\"__null__\" dev=tmpfs ino=2580 scontext=u:r:watchdogd:s0 tcontext=u:object_r:device:s0 tclass=chr_file\ntype=1400 msg=audit(1417405598.000:10): avc: denied { open } for pid=2267 comm=\"watchdogd\" name=\"__null__\" dev=tmpfs ino=2580 scontext=u:r:watchdogd:s0 tcontext=u:object_r:device:s0 tclass=chr_file\ntype=1400 msg=audit(1417405598.000:11): avc: denied { unlink } for pid=2267 comm=\"watchdogd\" name=\"__null__\" dev=tmpfs ino=2580 scontext=u:r:watchdogd:s0 tcontext=u:object_r:device:s0 tclass=chr_file\ntype=1400 msg=audit(1417416653.602:575): avc: denied { getattr } for pid=3696 comm=\"onCtsTestRunner\" path=\"/dev/watchdog\" dev=tmpfs ino=1095 scontext=u:r:untrusted_app:s0:c512,c768 tcontext=u:object_r:watchdog_device:s0 tclass=chr_file\n\n```", "```kt\nout/host/linux-x86/bin/checkpolicy: loading policy configuration from out/target/product/udoo/obj/ETC/sepolicy_intermediates/policy.conf\nlibsepol.check_assertion_helper: neverallow on line 5375 violated by allow watchdogd device:chr_file { read write open };\nError while expanding policy\n\n```", "```kt\n#============= wpa ==============\nallow wpa device:chr_file { read open };\nallow wpa log_device:chr_file { write open };\nallow wpa system_data_file:dir { write remove_name add_name setattr };\nallow wpa system_data_file:sock_file { write create unlink setattr };\n```", "```kt\ntype=1400 msg=audit(1417405614.060:193): avc: denied { setattr } for pid=2639 comm=\"wpa_supplicant\" name=\"wpa_supplicant\" dev=mmcblk0p4 ino=129295 scontext=u:r:wpa:s0 tcontext=u:object_r:system_data_file:s0 tclass=dir\ntype=1400 msg=audit(1417405614.060:194): avc: denied { write } for pid=2639 comm=\"wpa_supplicant\" name=\"wlan0\" dev=mmcblk0p4 ino=129318 scontext=u:r:wpa:s0 tcontext=u:object_r:system_data_file:s0 tclass=sock_file\ntype=1400 msg=audit(1417405614.060:195): avc: denied { write } for pid=2639 comm=\"wpa_supplicant\" name=\"wpa_supplicant\" dev=mmcblk0p4 ino=129295 scontext=u:r:wpa:s0 tcontext=u:object_r:system_data_file:s0 tclass=dir\ntype=1400 msg=audit(1417405614.060:196): avc: denied { remove_name } for pid=2639 co\n\n```", "```kt\n/data/system/wpa_supplicant:\nsrwxrwx--- wifi wifi 2014-12-01 06:43 wlan0\n\n```", "```kt\ntype=1400 msg=audit(1417405613.640:175): avc: denied { read } for pid=2639 comm=\"wpa_supplicant\" name=\"rfkill\" dev=tmpfs ino=1126 scontext=u:r:wpa:s0 tcontext=u:object_r:device:s0 tclass=chr_file\n\n```", "```kt\n#============= init ==============\nallow init rootfs:file { write create };\nallow init system_file:file execute_no_trans;\n#============= shell ==============\nallow shell device:chr_file { read write getattr };\nallow shell system_file:file entrypoint;\n```", "```kt\n<5>type=1400 audit(4.380:3): avc: denied { create } for pid=2268 comm=\"init\" name=\"tasks\" scontext=u:r:init:s0 tcontext=u:object_r:rootfs:s0 tclass=file\n<5>type=1400 audit(4.380:4): avc: denied { write } for pid=2268 comm=\"init\" name=\"tasks\" dev=rootfs ino=3080 scontext=u:r:init:s0 tcontext=u:object_r:rootfs:s0 tclass=file\n\n```", "```kt\nallow int rootfs:file create_file_perms;\n```", "```kt\n# Nothing should be writing to files in the rootfs.\nneverallow { domain -recovery} rootfs:file { create write setattr relabelto append unlink link rename };\n```", "```kt\n# Nothing should be writing to files in the rootfs.\nneverallow { domain -recovery -init } rootfs:file { create write setattr relabelto append unlink link rename };\n```", "```kt\n<5>type=1400 audit(4.460:6): avc: denied { execute_no_trans } for pid=2292 comm=\"init\" path=\"/system/bin/magd\" dev=mmcblk0p5 ino=146 scontext=u:r:init:s0 tcontext=u:object_r:system_file:s0 tclass=file\n<5>type=1400 audit(4.460:6): avc: denied { execute_no_trans } for pid=2292 comm=\"init\" path=\"/system/bin/rfkill\" dev=mmcblk0p5 ino=148 scontext=u:r:init:s0 tcontext=u:object_r:system_file:s0 tclass=file\n\n```", "```kt\ntype magd, domain;\ntype magd_exec, exec_type, file_type;\npermissive_or_unconfined(magd);\n```", "```kt\n/system/bin/magd  u:object_r:magd_exec:s0\n```", "```kt\n<5>type=1400 audit(4.460:5): avc: denied { entrypoint } for pid=2279 comm=\"init\" path=\"/system/bin/mksh\" dev=mmcblk0p5 ino=154 scontext=u:r:shell:s0 tcontext=u:object_r:system_file:s0 tclass=file\n```", "```kt\ntype init_shell, domain;\ndomain_auto_trans(init, shell_exec, init_shell);\npermissive_or_unconfined(init_shell);\n```", "```kt\n/system/bin/mksh  u:object_r:shell_exec:s0;\n```", "```kt\n<5>type=1400 audit(6.510:7): avc: denied { read write } for pid=2279 comm=\"sh\" name=\"ttymxc1\" dev=tmpfs ino=122 scontext=u:r:shell:s0 tcontext=u:object_r:device:s0 tclass=chr_file\n<5>type=1400 audit(7.339:8): avc: denied { getattr } for pid=2279 comm=\"sh\" path=\"/dev/ttymxc1\" dev=tmpfs ino=122 scontext=u:r:shell:s0 tcontext=u:object_r:device:s0 tclass=chr_file\n\n```", "```kt\n/dev/ttymxc[0-9]*  u:object_r:tty_device:s0\n```", "```kt\nsetcon u:r:init:s0\nsetenforce 1\n```", "```kt\nroot@udoo:/ # getenforce\nEnforcing\nroot@udoo:/ # reboot\nreboot: Operation not permitted\n\n```"]