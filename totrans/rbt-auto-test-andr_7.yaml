- en: Chapter 7. Other Robotium Utilities
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: This chapter consists of various utilities present in the Robotium Framework.
    These utilities include the `RobotiumUtils` class, XPath usage, Robotium usage
    for the already installed Android applications, and the signature process involved
    during the application sign-unsign operation to perform tests. Let's see these
    utilities one by one in this chapter.
  prefs: []
  type: TYPE_NORMAL
- en: The RobotiumUtils class
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: The `RobotiumUtils` class was introduced in the Robotium v4.2\. It contains
    the utility methods. Let's see the API set for the class `RobotiumUtils`.
  prefs: []
  type: TYPE_NORMAL
- en: '![The RobotiumUtils class](img/8010OS_07_01.jpg)'
  prefs: []
  type: TYPE_IMG
- en: API set
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'The `RobotiumUtils` class provides methods for sorting, ordering, filtering
    views, and so on. The different methods for providing these features are as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: 'The following method filters the views based on the class passed as a parameter:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'The following method filters all the views that are not present in the `classSet`
    parameter:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'The following method checks if a view matches the `stringToMatch` variable
    and returns the number of matches found:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'The following method removes all the views whose visibility is invisible:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE3]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'The following method sorts all the views by their location on the screen:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE4]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: The following method filters the views collection and returns the views that
    match a specified regular expression.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE5]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: Note
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: 'You can get more information about these methods from the following link:'
  prefs: []
  type: TYPE_NORMAL
- en: '[http://robotium.googlecode.com/svn/doc/com/jayway/android/robotium/solo/RobotiumUtils.html](http://robotium.googlecode.com/svn/doc/com/jayway/android/robotium/solo/RobotiumUtils.html)'
  prefs: []
  type: TYPE_NORMAL
- en: XPath API and syntax
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Web Elements can be located by using an XPath-style expression. This helps testers
    to find the elements of DOM while keeping the tests resistant to the application
    UI. Note that this applies only to Web Elements inside the WebView application.
  prefs: []
  type: TYPE_NORMAL
- en: '![XPath API and syntax](img/8010OS_07_02.jpg)'
  prefs: []
  type: TYPE_IMG
- en: XPath is basically used to navigate through the attributes and elements in an
    XML document. A simple path expression can be used to navigate through XML documents
    using XPath.
  prefs: []
  type: TYPE_NORMAL
- en: 'Let us see a simple example that provides a basic understanding of how XPath
    is to be used:'
  prefs: []
  type: TYPE_NORMAL
- en: 'The following is the XML file that we have to parse using XPath:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE6]'
  prefs: []
  type: TYPE_PRE
- en: 'Suppose you want to extract the names of the authors from the previous XML
    file. The function to do it using XPath is as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE7]'
  prefs: []
  type: TYPE_PRE
- en: 'You can find Web Elements by using the following XPath expression example:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE8]'
  prefs: []
  type: TYPE_PRE
- en: Robotium for pre-installed applications
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Robotium allows writing and running test cases for the pre-installed applications
    in Android. To do this, you need to perform the re-sign operation on the target
    application with the debug key that you are using for the test project. This requires
    access to the `/system/app` folder on the device. To access this folder, you must
    have a rooted device.
  prefs: []
  type: TYPE_NORMAL
- en: '![Robotium for pre-installed applications](img/8010OS_07_03.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Note
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Please note that some of the preinstalled applications for which the re-sign
    operation is performed don't work properly. These applications don't even show
    up when re-signed with the new debug key.
  prefs: []
  type: TYPE_NORMAL
- en: 'To re-sign an APK file, you can follow the listed steps:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Log in as root: `adb root`.'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Remount using the following code
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE9]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: Re-sign the `ApplicationName.apk` file, so that it has the same certificate
    debug key signature signing as the `adb pull /data/system/packages.xml` test project.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Open `packages.xml` and remove the following code:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE10]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: Push `packages.xml` back to the `adb push packages.xml /data/system` device.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Restart your device.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Push the re-signed `ApplicationName.apk` file back to the `adb push ApplicationName.apk
    /system/app` device.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Test for only APK
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: The APK file to be tested should have the same certificate signature as the
    test project. If the signatures are different, a mismatch will occur.
  prefs: []
  type: TYPE_NORMAL
- en: '![Test for only APK](img/8010OS_07_04.jpg)'
  prefs: []
  type: TYPE_IMG
- en: If you know the APK certificate signature, sign the test project with the same
    signature.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: If the APK is not signed, sign the APK with the Android debug key signature.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: If you don't know the APK certificate signature, delete its certificate signature
    and provide the debug key signature to the APK and your test project.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Signature process
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: In Android OS, all the applications are signed with the certificate whose private
    key is held by the app developer.
  prefs: []
  type: TYPE_NORMAL
- en: 'There are two build modes to build your Android application. They are as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: Debug mode
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Release mode
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The Android build process signs the application depending on the type of build
    mode. The Debug mode is mostly used when you are developing and testing the application,
    whereas the Release mode is used when you want to distribute the released version
    of your application to the users, or publish the application in the marketplace
    such as the **Google Play Store**.
  prefs: []
  type: TYPE_NORMAL
- en: '![Signature process](img/8010OS_07_05.jpg)'
  prefs: []
  type: TYPE_IMG
- en: The `Keytool` utility is used to create a debug key when you are using a build
    mode. The alias and password of the debug key are known to the SDK build tools.
    This is why tools don't prompt you for the debug key's alias and password every
    time the program is compiled.
  prefs: []
  type: TYPE_NORMAL
- en: The private key is used when you build your application in the Release mode.
    If you don't have a private key with you, the `Keytool` utility creates one for
    you. When your application is compiled in the Release mode, the build tools use
    your private key, along with the `jarsigner` utility to sign the application APK
    file.
  prefs: []
  type: TYPE_NORMAL
- en: Whenever you debug or run your application using Eclipse with the ADT plugin
    installed, the debug key signing process happens automatically in the background.
    The same signing process is followed when using an Ant script with the debug option
    enabled to build the application. The *Eclipse Export wizard* helps automating
    the release signing process or modifying the Ant build script and building applications
    with the release option.
  prefs: []
  type: TYPE_NORMAL
- en: 'To unsign a signed APK and then sign it with the debug key, perform the following
    steps:'
  prefs: []
  type: TYPE_NORMAL
- en: Unzip the APK file using any ZIP extractor.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Delete the `Meta-INF` folder.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Rezip the extracted files to an APK file and change the extension from `appname.apk.zip`
    to `appname.apk`. This way, you can un-sign the signed APK!
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'To sign this APK with the Android debug signature key, run the following command
    in the command prompt:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE11]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: The `jarsigner` utility can be found under the JDK binaries and *zipalign* is
    an Android SDK part.
  prefs: []
  type: TYPE_NORMAL
- en: The *zipalign* tool is used for optimization of the Android APK files. Its basic
    purpose is to have the uncompressed data alignment relative to the start of the
    file.
  prefs: []
  type: TYPE_NORMAL
- en: 'With the help of Eclipse, you can also sign and export your Android app. Perform
    the following steps:'
  prefs: []
  type: TYPE_NORMAL
- en: Right-click on the Android project and navigate to **Android Tools** | **Export
    Signed Application Package**.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: In the **Export** Android application wizard, select the project you want to
    export, and then click on **Next**.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: The **Keystore Selection** screen will appear.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: If you don't have the existing keystore, create a new keystore. You should be
    able to create a keystore by entering the location and password.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: After navigating to the folder you want to use, type a name in the **File name:**
    field in the file browse window, for example, `hrushikesh.keystore`. Then, you
    should be able to proceed with the key creation.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'For more information on APK signing, please refer to the following link:'
  prefs: []
  type: TYPE_NORMAL
- en: '[http://developer.android.com/tools/publishing/app-signing.html](http://developer.android.com/tools/publishing/app-signing.html)'
  prefs: []
  type: TYPE_NORMAL
- en: Summary
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In this chapter, you learned about the different utilities present in the Robotium
    Framework and their usage. In the next chapter, we will see the integration mechanism
    of Robotium with Maven, with some examples.
  prefs: []
  type: TYPE_NORMAL
