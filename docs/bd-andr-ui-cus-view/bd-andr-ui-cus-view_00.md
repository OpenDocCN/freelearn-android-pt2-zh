# 前言

多年前，在安卓和 iPhone 推出之前，一个主要的担忧是有没有一个集中的地方来购买和下载移动应用程序。如今，我们通过广泛可用的集中应用商店如谷歌应用商店解决了这个问题，但代价是应用程序的可发现性降低。

谷歌应用商店（Google Play）和其他移动应用商店一样，市场竞争已经高度饱和。除非一个应用有独特之处或者有特别之处，否则在众多功能相近甚至不相关的应用中脱颖而出是非常困难的。

增加市场营销投入可能会暂时缓解这个问题，但从长远来看，应用程序仍然需要找到那项独特的功能或那个使其与众不同的细节。

一个让应用与众不同的方法是从安卓标准小部件和 UI 组件中稍微偏离，加入特定的自定义视图或自定义菜单，或者，在最后，任何让应用变得卓越的东西。我们应该知道，这并不意味着我们应该完全忽视安卓标准小部件，重写整个应用程序的 UI。与几乎所有事情一样，进行用户测试，发现对他们来说什么有效，什么无效。探索新选项，解决他们遇到的问题，但不要过度。有时，在应用程序顶部创建一个特定的菜单可能解决了导航问题，或者一个定义良好的动画可能向用户正确传达了过渡。

在这本书中，我们将学习如何开始为安卓构建自定义视图并将其集成到我们的应用程序中。我们会详细探讨如何与这些视图互动，添加动画，并给出 2D 和 3D 渲染能力的综合示例。最后，我们还将学习如何共享我们的自定义视图，以便在企业环境中复用，以及如何开源它们，让安卓开发社区也能使用。

# 本书内容涵盖

第一章，*入门*，解释了自定义视图是什么，我们何时需要它们，并展示如何构建你的第一个自定义视图。

第二章，*实现你的第一个自定义视图*，更详细地介绍了测量、实例化、参数化以及一些基本的渲染，从而开始感受自定义视图能做什么。

第三章，*处理事件*，向读者展示如何让自定义视图具有交互性，以及如何响应用户的交互。

第四章，*高级 2D 渲染*，添加了额外的渲染原语和操作，并展示如何将它们组合起来构建更复杂的自定义视图。

第五章，*引入 3D 自定义视图*，因为我们的渲染不仅限于 2D，本章介绍了如何使用 OpenGL ES 渲染 3D 的自定义视图。

第六章，*动画*，讲述了如何为自定义视图添加动画，既可以使用标准的 Android 组件，也可以自己实现。

第七章，*性能考虑*，提出了一些建议和最佳实践，在构建自定义视图时应当遵循，以及不遵循可能产生的影响。

第八章，*分享我们的自定义视图*，讲述了如何打包和分享我们的自定义视图，使其公开可用。

第九章，*实现自己的电子节目指南*，展示了如何通过结合我们在书中看到的内容，构建一个更复杂自定义视图的例子。

第十章，*构建图表组件*，详细介绍了如何逐步构建一个可定制的图表自定义视图。

第十一章，*创建 3D 旋转菜单*，介绍了如何构建一个更复杂的 3D 自定义视图，用作选择菜单。

# 阅读本书所需

为了跟随本书中的示例，你需要安装 Android Studio。我们将在第一章简要介绍如何安装和设置设备模拟器。强烈建议至少安装 Android Studio 3.0。在撰写本书时，Android Studio 3.0 仍然是测试版，但足够稳定，可以开发、运行和测试所有示例。此外，建议使用 Android 设备以更好地体验我们将创建的自定义视图中的用户交互，但它们也可以在 Android 模拟器中工作。

# 本书适合的读者

本书适用于希望提高 Android 应用开发技能并使用自定义视图构建 Android 应用的开发者。

# 约定

在本书中，你会发现多种文本样式，用于区分不同类型的信息。以下是一些样式示例及其含义的解释。

文本中的代码字、数据库表名、文件夹名、文件名、文件扩展名、路径名、虚拟 URL、用户输入和 Twitter 处理程序如下所示：

"我们可以使用`getWidth()`和`getHeight()`方法分别获取视图的宽度和高度。"

代码块设置如下：

```kt
<com.packt.rrafols.customview.OwnTextView 
        android:layout_width="wrap_content" 
        android:layout_height="wrap_content" 
        android:text="Hello World!" /> 
```

当我们希望引起你对代码块中某个特定部分的注意时，相关的行或项目会以粗体设置：

```kt
float maxLabelWidth = 0.f; 
if (regenerate) { 
    for (int i = 0; i<= 10; i++) { 
        float step; 
 if (!invertVerticalAxis) {
 step = ((float) i / 10.f);
 } else {
 step = ((float) (10 - i)) / 10.f;
}
```

新术语和重要词汇以粗体显示，例如，它们在文本中这样出现："布局通常被称为**ViewGroup**。"

警告或重要说明会以这样的方框显示。

技巧和诀窍会以这样的形式出现。

# 读者反馈

我们始终欢迎读者的反馈。让我们知道您对这本书的看法——您喜欢或不喜欢什么。读者的反馈对我们很重要，因为它帮助我们开发出您真正能从中获得最大收益的标题。

如果要给我们发送一般反馈，只需发送电子邮件至`feedback@packtpub.com`，并在邮件主题中提及本书的标题。

如果你对某个主题有专业知识，并且有兴趣撰写或参与书籍编写，请查看我们的作者指南[www.packtpub.com/authors](http://www.packtpub.com/authors)。

# 客户支持

既然您已经拥有了 Packt 的一本书，我们有许多方法可以帮助您充分利用您的购买。

# 下载示例代码

您可以从[`www.packtpub.com`](http://www.packtpub.com)的账户下载本书的示例代码文件。如果您在别处购买了这本书，可以访问[`www.packtpub.com/support`](http://www.packtpub.com/support)注册，我们会直接将文件通过电子邮件发送给您。

按照以下步骤，您可以下载代码文件：

1.  使用您的电子邮件地址和密码登录或注册我们的网站。

1.  将鼠标悬停在顶部的“支持”标签上。

1.  点击“代码下载与勘误”。

1.  在搜索框中输入书名。

1.  选择您要下载代码文件的书。

1.  从下拉菜单中选择您购买本书的地方。

1.  点击“代码下载”。

文件下载后，请确保使用最新版本的以下软件解压或提取文件夹：

+   对于 Windows 系统，请使用 WinRAR / 7-Zip。

+   对于 Mac 系统，请使用 Zipeg / iZip / UnRarX。

+   对于 Linux 系统，请使用 7-Zip / PeaZip。

本书附带的代码包也托管在 GitHub 上，地址为[`github.com/PacktPublishing/Building-Android-UIs-with-Custom-Views`](https://github.com/PacktPublishing/Building-Android-UIs-with-Custom-Views)。我们还有其他丰富的书籍和视频代码包，可以在[`github.com/PacktPublishing/`](https://github.com/PacktPublishing/)找到。请查看！

# 勘误

尽管我们已经竭尽全力确保内容的准确性，但错误仍然可能发生。如果您在我们的书中发现了一个错误——可能是文本或代码中的错误——如果您能报告给我们，我们将不胜感激。这样做，您可以避免其他读者感到沮丧，并帮助我们在后续版本中改进这本书。如果您发现任何勘误，请通过访问[`www.packtpub.com/submit-errata`](http://www.packtpub.com/submit-errata)，选择您的书籍，点击“勘误提交表单”链接，并输入您的勘误详情。一旦您的勘误被验证，您的提交将被接受，勘误将被上传到我们的网站或添加到该标题下的现有勘误列表中。

要查看之前提交的勘误信息，请访问[`www.packtpub.com/books/content/support`](https://www.packtpub.com/books/content/support)，并在搜索字段中输入书名。所需信息将显示在勘误部分下。

# 盗版问题

互联网上对版权材料进行盗版是一个所有媒体都面临的持续问题。在 Packt，我们非常重视保护我们的版权和许可。如果您在互联网上以任何形式遇到我们作品的非法副本，请立即提供位置地址或网站名称，以便我们可以寻求补救措施。

如果您发现疑似盗版材料，请通过 `copyright@packtpub.com` 联系我们，并提供相关链接。

我们感谢您帮助保护我们的作者以及我们为您提供有价值内容的能力。

# 问题咨询

如果您对本书的任何方面有问题，可以通过 `questions@packtpub.com` 联系我们，我们将尽力解决问题。
